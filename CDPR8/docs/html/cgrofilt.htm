<!DOCTYPE html>
<html lang="en">
<!-- cgrofilt.htm  - HTML5 version -->
<html>

<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>CDP FILTER Functions</title>
<meta charset="UTF-8" />
	<link rel = "stylesheet"
	 type = "text/css"
	 href = "cdpmanshtml5.css" />
<link rel="icon"  href="images/cdp_favicon.ico">
    <style>
	a { text-decoration: none }
	a:hover { color:#FF3333;
          text-decoration: underline }          	
    </style>
</head>

<body>

<div id = "left"> <!-- Keep indexing on left ABOVE headlines so index goes to top of page -->

  <p>
  <div align = "center">
  <IMG SRC = "images/cdpcircs90.jpg"></a>
  </div>
  </p>

  <p>
  <nav>
  <!-- list-style-type NOT removing bullets in IE9, using Definition List -->
  <dl>
  <dt><a href="ccdpndex.htm" Target="_top"><b>Main Index</b></a>
  <dt><a href="cgroundx.htm" Target="_top"><b>'Groucho' Index</b></a> 
  <dt><a href="filestxt.htm" Target="_blank"><b>File Formats</b></a>
  <hr>
  <br />
  <dt><a href="#FILTLIST"><b>FILTER:</b></a>
  <dt>&nbsp;&nbsp;<a href = "#BANK"><b>BANK</b></a>
  <dt>&nbsp;&nbsp;<a href = "#BANKFRQS"><b>BANKFRQS</b></a>
  <dt>&nbsp;&nbsp;<a href = "#FIXED"><b>FIXED</b></a>
  <dt>&nbsp;&nbsp;<a href = "#ITERATED"><b>ITERATED</b></a>
  <dt>&nbsp;&nbsp;<a href = "#LOHI"><b>LOHI</b></a>
  <dt>&nbsp;&nbsp;<a href = "#PHASING"><b>PHASING</b></a>
  <dt>&nbsp;&nbsp;<a href = "#SWEEPING"><b>SWEEPING</b></a>
  <dt>&nbsp;&nbsp;<a href = "#USERBANK"><b>USERBANK</b></a>
  <dt>&nbsp;&nbsp;<a href = "#VARIABLE"><b>VARIABLE</b></a>
  <dt>&nbsp;&nbsp;<a href = "#VARIBANK"><b>VARIBANK</b></a>
  <dt>&nbsp;&nbsp;<a href = "#VARIBANK"><b>VARIBANK2</b></a>
  <dt>&nbsp;&nbsp;<a href = "#VFILTERS"><b>VFILTERS</b></a>

  <br /><br />
  <b>OTHERS:</b><br>
  <dt>&nbsp;&nbsp;<a href = "#FILTRAGE"><b>FILTRAGE</b></a>
 <dt>&nbsp;&nbsp;<a href ="#PHASOR"><b>PHASOR</b></a>
  <br><br>
  <b>SEE ALSO:</b><br>
  <dt>&nbsp;&nbsp;<a href="cxreverb.htm#FASTCONV"><b>FASTCONV</b></a>
  <dt>&nbsp;&nbsp;<a href="cgrosynt.htm#SYNFILT"><b>SYNFILT</b></a>
  <dt>&nbsp;&nbsp;<a href="chilite.htm"><b>HILITE group</b></a> 
  <!-- 
  <br /><br /> 
  <dt><a href = "#TECHNICAL"><b>Technical</b></a>
  <br /><br />
   -->
  </dl>
  </p>

</div>  <!-- End of left index panel -->

<div id = "right"> <!-- Keep headlines here so index goes to top of page -->

   <div id = "head">

   <!-- 
   <p><IMG SRC="images/cdpcircs.jpg" align=left ALT="CDP circles logo"></a></p>
   -->
   <div align=center>
   <br>
   <img src="images/cdplogo2.jpg" ALT="CDP Logo">
   </div>

   <h1 align=center>CDP FILTER Functions</h1>
   <h2 align=center><font color="#3366ff"> (with Command Line Usage)</font></h2>
   </div>  <!-- End of 'head' -->


<!-- ========================================================================= -->
<h2 align = "center" id="FILTLIST">Functions to FILTER soundfiles</h2>

<p>
<b><i>
Names in brackets mean that these are separate programs.  The others are sub-modules of FILTER.</i></b>
</p>

<dl>
<dt><a href="#BANK"><b>BANK</b></a> <dd>Bank of filters, with time-varying <i>Q</i> </dd>
<dt><a href="#BANKFRQS"><b>BANKFRQS</b></a> <dd>Generate a bank of frequencies for use as a filterbank </dd>
<dt><a href="#FILTRAGE"><b>[FILTRAGE]</b></a> <dd>Generate randomised VARIBANK filterbank files </dd>
<dt><a href="#FIXED"><b>FIXED</b></a> <dd>Boost or Cut: above, below or around a given frequency </dd>
<dt><a href="#ITERATED"><b>ITERATED</b></a> <dd>Iterate a sound, with cumulative filtering by a filterbank </dd>
<dt><a href="#LOHI"><b>LOHI</b></a> <dd>Fixed low pass or high pass filter </dd>
<dt><a href="#PHASING"><b>PHASING</b></a> <dd>Phase shift sound, or produce phasing effect </dd>
<dt><a href="#PHASOR"><b>PHASOR</b></a> <dd> Introduce phasing into (mono) signal </dd>
<dt><a href="#SWEEPING"><b>SWEEPING</b></a> <dd>Filter whose focus-frequency sweeps over a range of frequencies </dd>
<dt><a href="#USERBANK"><b>USERBANK</b></a> <dd>User-defined filterbank, with time-varying <i>Q</i> </dd>
<dt><a href="#VARIABLE"><b>VARIABLE</b></a> <dd>Lo-pass, High-pass, Band-pass or Notch filter with time-varying frequency </dd>
<dt><a href="#VARIBANK"><b>VARIBANK</b></a> <dd>User-defined time-varying filterbank, with time-varying <i>Q</i> </dd>
<dt><a href="#VFILTERS"><b>VFILTERS</b></a> <dd>Make datafiles for fixed-pitch FILTER VARIBANK filters </dd>
<br><br>
<dt><br>
<b>SEE ALSO:</b>
<dt><a href="cxreverb.htm#FASTCONV"><b>[FASTCONV]</b></a><dd>Multi-channel fast convolution</dd>
<dt><a href="cgrosynt.htm#SYNFILT"><b>[SYNFILT]</b></a> <dd> Noise filtered by time-varying filterbank, with time-variable Q </dd> 
<dt><a href="chilite.htm"><b>HILITE group</b></a> <dd>Includes spectral filtering functions</dd>

</dl>

<h3>General comment about FILTER</h3>

<blockquote>
When filters of time-varying Q are used, the output level tends
to drop as the Q increases.  This can be compensated for later by
using <a href="cgromody.htm#LOUDNESS"><b>MODIFY LOUDNESS</b></a>, Mode <b>5</b>
(Balance sources), submitting the original file and the filtered file as
the two sources.  The resultant soundfile will have the sound of the
filtered file with the amplitude contour of the original sound.
</blockquote>

<hr><!-- ****************************************************** -->

<h2 id="BANK">FILTER BANK &#150; Bank of filters, with time-varying <i>Q</i>
</h2>

<h3>
Usage
</h3>
<b>filter bank 1&#150;3</b> <i>infile outfile Q gain lofrq hifrq</i>
[<b>-s</b><i>scat</i>] [<b>-d</b>]<br>
OR:<br>
<b>filter bank 4&#150;6</b> <i>infile outfile Q gain lofrq hifrq param</i>
[<b>-s</b><i>scat</i>] [<b>-d</b>]<br>

<h3>
Modes
</h3>

<blockquote>
<b>1</b>&nbsp; HARMONIC SERIES over <i>lofrq</i><br>
<b>2</b>&nbsp; ALTERNATE HARMONICS over <i>lofrq</i><br>
<b>3</b>&nbsp; SUBHARMONIC SERIES below <i>hifrq</i><br>
<b>4</b>&nbsp; HARMONIC SERIES WITH LINEAR OFFSET: <i>param</i> = offset in Hz<br>
<b>5</b>&nbsp; EQUAL INTERVALS BETWEEN <i>lofrq</i> and <i>hifrq</i>:
<i>param</i> = number of filters<br>
<b>6</b>&nbsp; EQUAL INTERVALS BETWEEN <i>lofrq</i> and <i>hifrq</i>:
<i>param</i> = number of semitones in the interval<br>
</blockquote>

<h3>
Parameters
</h3>

<blockquote>
<i>infile</i> &#150; input soundfile to filter<br>
<i>outfile</i> &#150; output (filtered) soundfile<br>
<i>Q</i> &#150; 'tightness' of filters (Range: 0.00100 &lt;= <i>Q</i>
&lt; 10000) &#150; the higher the value the more tightly the filter is
focused on the centre frequency of that filter.
	<blockquote>
	<i>Q</i> may vary over time.
	</blockquote>
<i>gain</i> &#150; overall gain (Range: 0.00100 to 10000.0)<br>
<i>lofrq</i> &#150; low frequency limit of filters (Range: 10 to
sample_rate&#47;3)<br>
<i>hifrq</i> &#150; high frequency limit of filters (Range: <i>lofrq+</i>
to sample_rate&#47;3)<br>
<i>param</i> &#150;
	<ul>
	<li>in Mode <b>4</b>, offset in Hz</li>
	<li>in Mode <b>5</b>, number of filters</li>
	<li>in Mode <b>6</b>, number of semitones in interval</li>
	</ul>
<b>-s</b><i>scat</i> &#150; random scatter of filter frequencies
(Range: 0 to 1; the Default is 0)<br>
<b>-d</b> &#150; double filtering<br>
</blockquote>

<h3>
Understanding the FILTER BANK Process
</h3>

<blockquote>
<p>
It may be helpful to compare this function with <a href="#USERBANK"><b>FILTER USERBANK</b></a> and <a href="#VARIBANK"><b>FILTER VARIBANK</b></a>, which allow the user to specify the frequency centres for the bank of filters.  FILTER BANK handles the definition
of the frequencies for you, by means of a variety of presets.
</p>

<p>
Each Mode operates a different preset.  This is how they work:
<ul>
<li>Mode <b>1</b> &#150; The harmonic series is formed by multiplying
a given frequency by an ascending series of integers: 1, 2, 3, 4, etc.
The harmonic relationships produced are sonorous, but depart from
the structure of triadic chords higher in the series.  This Mode builds
this type of harmonic relationship onto <i>lofrq</i>, which may be
the actual pitch of a pitched tone or any arbitrary pitch.  Because
this is being done with a filter process, other sonic material is
cleaned away, so a cleaner (and possibly quieter) sound may result,
with more complex noise elements removed.  Quite a bit of gain
may be required &#150; values of 40 or 50+ in this situation will not
be unusual.  Set <i>hifrq</i> as high as possible less too few harmonics
are produced.  This clean sound may provide a good input for spectral
time-stretching, for example, to achieve a well-tuned sound with a minimum
of artefacts.</li>

<p>
<li>Mode <b>2</b> &#150; This will be like Mode <b>1</b> but with
every other harmonic omitted: the <b>odd</b> numbered partials are
retained.  The resulting sound will probably sound more 'hollow'.</li>
</p>

<p>
<li>Mode <b>3</b> &#150; The 'subharmonic series' is the intervallic
inverse of the harmonic series.  Thus the departure from triadic-type
intervals increases as the series descends.  The resulting sound has
a deeper tone and is somewhat hollow and somewhat inharmonic.</li>
</p>

<p>
<li>Mode <b>4</b> &#150; The offset in Hz is added to each harmonic.
This will displace them so that they will no longer be exact multiples
of the fundamental.  This means that the cycles of the waveforms no
longer line up at nodes, which introduces an 'inharmonic' dimension
into the sound, heard as an increase in timbral components.</li>
</p>

<p>
<li>Mode <b>5</b> &#150; Here we depart from the harmonic series and
simply divide up the specified frequency range into an equal number
filters:  how many is specified by the user with <i>param</i>.  The
first effect this equal spacing will have is to create inharmonic
(rather than integer multiple) relationships between the partials.
A low number of filters will produce an 'open' sound, and a high
number of filters will produce a denser, richer sound.  These might
be very interesting sounds to timestretch.</li>
</p>

<p>
<li>Mode <b>6</b> &#150; By specifying the interval (in semitones), we
in effect repeat these intervals within the frequency space between
<i>lofrq</i> and <i>hifrq</i>, thus producing complex chords composed
of the same interval 'piled up'.  This is a quick way to 'harmonise'
a sound, with the resulting density dependent on the size of the
interval.  It is well worth re-running this function, entering
intervals from 1 to 7, for example, to hear what kind of transformations
will be produced.  Some unexpected resonances may result;  they could
be filtered out later.</li>
</p>
</ul>
</blockquote>

<h3>
Musical Applications
</h3>

<blockquote>
<p>
The use of the presets provide quick ways to create a variety of
harmonic and inharmonic transformations.  The resulting sounds have
a sonorous, chordal quality.  One may need to push the gain control
as far as it can go without overloading, less too much signal is
lost through the filtering process.
</p>

<p>
The resulting sounds can be used for rich, sonorous textures or
clean time-stretching, or other spectral transformations.
</p>

<p>
Having said that, the 'chordal quality' will be diminished if the
<i>Q</i> is lower (i.e., less pitch focus).  Also note that a lower
<i>Q</i> 'lets through' more of the original signal, so the <i>gain</i>
will also have to be reduced.  For example, with a <i>Q</i> of 100, a
<i>gain</i> of 100 worked fine;  but with a <i>Q</i> of 100, a <i>gain</i>
of 5 was required (for the source sound used).
</p>
</blockquote>

<p>
End of FILTER BANK<br>
<a href="#FILTLIST"><b>Return</b></a> to list of FILTER functions at top
of this file<br>
<a href="ccdpndex.htm" Target="_top"><b>Return</b></a>
to Main Index for the CDP System.<br>
<a href="cgroundx.htm#startpos" Target="_top"><b>Return</b></a>
to 'Groucho' Time-Domain Index
</p>

<hr><!-- ****************************************************** -->

<h2 id="BANKFRQS">FILTER BANKFRQS &#150; Generate a bank of frequencies
for use as a filterbank
<br> 
(Add amplitudes to the textfile for use with FILTER USERBANK)
</h2>

<h3>
Usage
</h3>

<b>filter bankfrqs 1&#150;3</b> <i>anysndfile outtextfile lofrq hifrq</i>
[<b>-s</b><i>scat</i>]<br>
OR:<br>
<b>filter bankfrqs 4&#150;6</b> <i>anysndfile outtextfile lofrq hifrq param</i>
[<b>-s</b><i>scat</i>]<br>

<h3>
Modes
</h3>

<blockquote>
<b>1</b>&nbsp; HARMONIC SERIES over <i>lofrq</i><br>
<b>2</b>&nbsp; ALTERNATE HARMONICS over <i>lofrq</i><br>
<b>3</b>&nbsp; SUBHARMONIC SERIES below <i>hifrq</i><br>
<b>4</b>&nbsp; HARMONIC SERIES WITH LINEAR OFFSET: <i>param</i> = offset in Hz<br>
<b>5</b>&nbsp; EQUAL INTERVALS BETWEEN <i>lofrq</i> and <i>hifrq</i>:
<i>param</i> = number of filters<br>
<b>6</b>&nbsp; EQUAL INTERVALS BETWEEN <i>lofrq</i> and <i>hifrq</i>:
<i>param</i> = number of semitones in the interval<br>
</blockquote>

<h3>
Parameters
</h3>

<blockquote>
<i>infile</i> &#150; input soundfile to filter<br>
<i>outtextfile</i> &#150; output textfile containing frequency data<br>
<i>lofrq</i> &#150; low frequency limit of filters (Range: 10 to
sample_rate&#47;3)<br>
<i>hifrq</i> &#150; high frequency limit of filters (Range: <i>lofrq+</i>
to sample_rate&#47;3)<br>
	<blockquote>
	<b>NB:</b> The sample rate of the input soundfile determines the
	filter frequency range.
	</blockquote>
<i>param</i> &#150;
	<ul>
	<li>in Mode <b>4</b>, offset in Hz</li>
	<li>in Mode <b>5</b>, number of filters</li>
	<li>in Mode <b>6</b>, number of semitones in interval</li>
	</ul>
<b>-s</b><i>scat</i> &#150; random scatter of filter frequencies
(Range: 0 to 1; the Default is 0)<br>
</blockquote>

<h3>
Understanding the FILTER BANKFRQS Function
</h3>

<blockquote>
<p>
This function carries out the same operations as FILTER BANK, but writes
the resulting frequencies to a textfile rather than applying them to a
soundfile.
</p>

<p>
<b>NB:</b> An existing <i>outtextfile</i> of the same name will be
overwritten without checking with you first.
</p>

<p>
See <a href="#BANK"><b>FILTER BANK</b></a> for the meaning of each Mode.
</p>
</blockquote>

<h3>
Musical Applications
</h3>

<blockquote>
<p>
This textfile can then be edited and is then available as
an input to <a href="#USEBANK"><b>FILTER USERBANK</b></a> and <a href="#VARIBANK">
<b>FILTER VARIBANK</b></a>, the filter bank functions which take a user-defined
set of filter centre-frequencies as an input.
</p>
</blockquote>

<p>
End of FILTER BANKFRQS<br>
<a href="#FILTLIST"><b>Return</b></a> to list of FILTER functions at top
of this file<br>
<a href="ccdpndex.htm" Target="_top"><b>Return</b></a>
to Main Index for the CDP System.<br>
<a href="cgroundx.htm#startpos" Target="_top"><b>Return</b></a>
to 'Groucho' Time-Domain Index
</p>

<hr> <!-- ************************************************************* -->

<h2 id="FILTRAGE">FILTRAGE &#150; Generate randomised VARIBANK filterbank files
</h2>

<h3>
Usage
</h3>
<b>filtrage filtrage 1</b> <i>outfiltdatafile dur cnt min max distrib rand ampmin amprand ampdistrib</i> [<b>-s</b><i>seed</i>]<br />
<br />
<b>filtrage filtrage 2</b> <i>outfiltdatafile dur cnt min max distrib rand ampmin amprand ampdistrib timestep timerand</i> [<b>-s</b><i>seed</i>]<br />


<p>
Example command line to create a randomised filterbank:<br>
	<blockquote>
	<b><code>filtrage filtrage 1 filtout.txt 10 4 36 72 1 0.75 0.5 0.5 0 2 0</code></b>
	</blockquote>
</p>

<h3>
Modes
</h3>

<blockquote>
<b>1</b>&nbsp; Generate a fixed filter data file<br />
<b>2</b>&nbsp; Generate a time-varying filter data file
</blockquote>

<h3>
Parameters
</h3>

<blockquote>
<i>outfiltdata</i> &#150; output text file containing the time-varying filterbank data for <a href = "cgrofilt.htm#VARIBANK"><b>FILTER VARIBANK</b></a><br />
<i>dur</i> &#150; the duration spanned by the output filter file<br />
<i>cnt</i> &#150; the number of parallel filters<br />
<i>min</i> &#150; the minimum MIDI value for the filters <br />
<i>max</i> &#150; the maximum MIDI value for the filters<br />
<i>distrib</i> &#150; the distribution of pitch values:<br />
  &nbsp;&nbsp;&bull;&nbsp;&nbsp; <b>1</b> = pitch-linear<br />
  &nbsp;&nbsp;&bull;&nbsp;&nbsp; <b>&gt; 1</b> squeezes the filter towards the low pitches<br />
  &nbsp;&nbsp;&bull;&nbsp;&nbsp; <b>&lt; 1</b> squeezes the filter towards the high pitches<br />
<i>rand</i> &#150; randomisation of the filter pitches<br />
<i>ampmin</i> &#150; the minimum filter amplitude.  The maximum amplitude allowed here is = 1.0<br />
<i>amprand</i> &#150; randomisation of the filter amplitudes<br />
<i>ampdistrib</i> &#150; the distribution of the filter amplitudes:<br />
  &nbsp;&nbsp;&bull;&nbsp;&nbsp; <b>1</b> = increasing with pitch<br />
  &nbsp;&nbsp;&bull;&nbsp;&nbsp; <b>-1</b> = decreasing with pitch<br />
  &nbsp;&nbsp;&bull;&nbsp;&nbsp; <b>0</b> = random<br />
  &nbsp;&nbsp;&bull;&nbsp;&nbsp; Intermediate values give decreasing degrees of randomisation.<br />
<i>timestep</i> &#150; the amount of time in seconds between each specified set of filter-pitches<br />
<i>timerand</i> &#150; randomisation of the <i>timestep</i><br />
<b>-s</b><i>seed</i> &#150; non-zero values fix the randomisation so that, on repeating the process identical random values are produced.
</blockquote>

<h3>
Understanding the FILTRAGE Function
</h3>

<blockquote>
Filtrage produces a filter data file for <a href="#VARIBANK"><b>FILTER VARIBANK</b></a>, with random frequencies. These are distributed within the desired frequency range either evenly, or skewed toward the top or bottom of the range. 
The command line above (4 filters, MIDI range 36-72, and a set of values every 2") produced this file:
<pre>
<font color="#FF0000">Time   Frequencies</font>
 0.00  36.652402  0.962668  48.366554  0.835011  54.429201  0.673751  60.270501  0.514595
 2.00  37.025983  0.993088  46.420885  0.844629  54.091361  0.700716  62.949427  0.506138
 4.00  37.794362  0.842264  48.314848  0.675147  54.824309  0.972373  61.072253  0.506926
 6.00  37.754604  0.961428  46.912400  0.697998  56.042592  0.852223  61.980918  0.539829
 8.00  38.631340  0.983648  47.445116  0.874975  55.960192  0.708066  60.152669  0.525479
10.00  38.285569  0.868233  45.837905  0.707601  56.749790  0.988629  62.810274  0.511495
</pre>
The randomisation is not as great as you might imagine, but permits a controllable degree of variation of amplitude, frequency and output times, which can be further adjusted manually as required.
</blockquote>

<h3>
Musical Applications
</h3>

<blockquote>
...
</blockquote>

<p>
End of FILTRAGE<br />
<a href="#FILTLIST"><b>Return</b></a> to list of FILTER functions at 
top of this file<br />
<a href="ccdpndex.htm" Target="_top"><b>Return</b></a> to Main Index for 
the CDP System.<br />
<a href="cgroundx.htm#startpos" Target="_top"><b>Return</b></a>
to 'Groucho' Time-Domain Index<br />
</p>

<hr> <!-- ************************************************************* -->

<h2 id="FIXED">FILTER FIXED &#150; Boost or Cut: above, below or
around a given frequency
</h2>

<h3>
Usage
</h3>
<b>filter fixed 1&#150;2</b> <i>infile outfile boost&#47;cut frequency</i>
[<b>-s</b><i>prescale</i>]<br>
<b>filter fixed 3</b> <i>infile outfile bandwidth boost&#47;cut frequency</i>
[<b>-s</b><i>prescale</i>]<br>

<h3>
Modes
</h3>

<blockquote>
<b>1</b>&nbsp; Boost or cut below a given frequency<br>
<b>2</b>&nbsp; Boost or cut above a given frequency<br>
<b>3</b>&nbsp; Boost or cut a band centered on a given frequency<br>
</blockquote>

<h3>
Parameters
</h3>

<blockquote>
<i>infile</i> &#150; input soundfile to filter<br>
<i>outfile</i> &#150; output (filtered) soundfile<br>
<i>bandwidth</i> &#150; filter bandwidth in Hz &#150; Mode <b>3</b> only<br>
<i>boost&#47;cut</i> &#150; amplitude boost or cut, in dB<br>
<i>frequency</i> &#150; the frequency of the filter in Hz<br>
<b>-s</b><i>prescale</i> &#150; scales gain on the <b>input</b> to the
filter<br>
</blockquote>

<h3>
Understanding the FILTER FIXED Process
</h3>

<blockquote>
<p>
This filter is referred to as 'fixed' because a single frequency of
fixed amplitude roll-off (<i>Q</i>), is preset within the function.
</p>

<p>
FILTER FIXED requires very precise frequency inputs.  It can therefore
be useful to analyse the sound and use SPECINFO PEAK get a profile of
the frequency bands in which most energy occurs.
</p>

<p>
For example, a trombone sound playing an F below Middle-C (174.61 Hz)
showed almost no change when this frequency was used as the input to
FILTER FIXED.  SPECINFO PEAK showed that the energy was concentrated
between 640 Hz and 905 Hz.  Mode <b>1</b> and Mode <b>2</b> inputs
relating to these frequencies worked fine:  e.g., filtering out below
905 Hz or above 640 Hz really made a difference;  similarly,
filtering out a 200 Hz band centered on 700 Hz.
</p>
</blockquote>

<h3>
Musical Applications
</h3>

<blockquote>
<p>
FILTER FIXED can be a quick way of achieving three common filtering
operations:  hi-pass (Mode <b>1</b>: cut below), lo-pass (Mode <b>2</b>:
cut above), or notch (Mode <b>3</b>: cut around), given a precise
knowledge of the frequency area to be filtered and an acceptance of
a fixed, average amount of <i>Q</i>.
</p>
</blockquote>

<p>
End of FILTER FIXED<br>
<a href="#FILTLIST"><b>Return</b></a> to list of FILTER functions at top
of this file<br>
<a href="ccdpndex.htm" Target="_top"><b>Return</b></a>
to Main Index for the CDP System.<br>
<a href="cgroundx.htm#startpos" Target="_top"><b>Return</b></a>
to 'Groucho' Time-Domain Index
</p>

<hr><!-- ****************************************************** -->

<h2 id="ITERATED">FILTER ITERATED &#150; Iterate a sound, with cumulative
filtering by a filterbank
</h2>

<h3>
Usage
</h3>
<b>filter iterated mode</b> <i>infile outfile datafile Q gain delay dur</i>
[<b>-s</b><i>prescale</i>] [<b>-r</b><i>rand</i>] [<b>-p</b><i>pshift</i>]
[<b>-a</b><i>ashift</i>] [<b>-d</b>] [<b>-i</b>] [<b>-e</b>] [<b>-n</b>]<br>

<h3>
Modes
</h3>

<blockquote>
<b>1</b>&nbsp; Enter filter pitches as frequency, in Hz<br>
<b>2</b>&nbsp; Enter filter pitches as MIDI note values
</blockquote>

<h3>
Parameters
</h3>

<blockquote>
<i>infile</i> &#150; input soundfile to filter<br>
<i>outfile</i> &#150; output (filtered) soundfile<br>
<i>datafile</i> &#150; contains the pitch and amplitude of the filters
(paired, one pair on each line)
	<ul>
	<li><b>Pitch:</b> as Hz or MIDI note values (Range: 10Hz to
	    sample_rate&#47;3)</li>

	<li><b>Amplitude:</b> amplitude level (Range: 0.00100 to 10000.0
	    or entered as dB values)</li>

	<li>Remember that it is possible to create a file of frequency
	    data with FILTER BANKFRQS and then edit it to add the
	    amplitude information.  Such files can be useful because
	    of their harmonic structure.</li>

	</ul>
<i>Q</i> &#150; 'tightness' of filters (Range: 0.00100 &lt;= <i>Q</i>
&lt; 10000) &#150; the higher the value the more tightly the filter is
focused on the centre frequency of that filter.
	<blockquote>
	<i>Q</i> may vary over time.
	</blockquote>
<i>gain</i> &#150; overall gain (Range: 0.00100 to 10000.0)<br>
<i>delay</i> &#150; average delay in seconds between iterations
(Range: &gt; 0 to 32767)<br>
<i>dur</i> &#150; (min) duration of output file (must be longer than
<i>infile</i><br>
<b>-s</b><i>prescale</i> &#150; scales gain on the <b>input</b> to the
filtering process (Range: 0.0 to 1.0; the Default is 1.0)
	<blockquote>
	If set to 0.0, FILTER ITERATE automatically divides the input
	level by the maximum number of sound overlays occurring in the
	iteration process.
	</blockquote>
<b>-r</b><i>rand</i> &#150; randomisation of the delay time (Range:
0 [none] to 1 [max])<br>
<b>-p</b><i>pshift</i> &#150; maxmimum pitch shift of any segment in
(fractions of) semitones (Range: &gt;= 0)<br>
<b>-a</b><i>ashift</i> &#150; maximum amplitude reduction of any
segment (Range: 0.0 to 1.0)<br>
<b>-d</b> &#150; double filtering<br>
<b>-i</b> &#150; turn off interpolation during filtering (makes it fast,
but dirty)<br>
<b>-e</b> &#150; add exponential decay:  each segment gets quieter
before the next segment enters<br>
<b>-n</b> &#150; turn off normalisation: segments may grow or fall in
amplitude quickly;  <i>gain</i> settings will have more impact when
<b>-n</b> is used &#150; but use this cautiously, as overload may
occur, which FILTER ITERATED does not report.
</blockquote>

<h3>
Understanding the FILTER ITERATED Process
</h3>

<blockquote>
<p>
Note that the duration of the output soundfile is set with <i>dur</i>,
it will usually be considerably longer than <i>infile</i> to provide
space in which the iterations can occur.  In effect, this determines
the number of iterations there will be, given the value for <i>delay</i>,
the time between iterations.
</p>

<p>
If you receive a message about 'insufficient memory', you can increase
the buffer capacity by increasing the buffer size.  This is done by
setting the environment variable CDP_MEMORY_BBSIZE.  This is 1 megabyte
by default.  The units are 1K each, so a buffer size of e.g., 6
megabytes can be set with the phrase: 'set CDP_MEMORY_BBSIZE=6000'.
Note that there must NOT be spaces before and after the equals sign.
This can be done in the existing DOS window, or in <i>autoexec.bat</i>
so that it sets this size upon boot-up.  If the latter, the new size
will not come into force until you re-boot.
</p>

<p>
More iterations means that the sound will be more filtered by
the time it reaches the end.  This has an important relationship
to <i>Q</i>, because the higher the <i>Q</i>, the more the original
sound material disappears into a pure and clean resonance as the
sound progresses.  Similarly, this resonance can be made to modulate
nicely by using some pitch transposition with <i>pshift</i>, producing
a weaving of differently tuned strands.
</p>

<p>
<i>Delay</i> is perhaps the key parameter, because it determines the
degree of overlap with each overlap &#150; or no overlap if it is
longer than <i>infile</i>.  A long <i>dur</i> (many iterations) with
a <i>delay</i> longer than <i>infile</i> means a series of differently
filtered repeats, with gaps between them.  Higher values of <i>rand</i>,
will close some of these gaps by introducing random overlaps.  However,
with no or occasional overlap, there will be no (or very little)
resonance effect.
</p>

<p>
<b>NB:</b> Each iteration begins at the beginning of <i>infile</i> and
plays <i>delay</i> amount of <i>infile</i>, before the next iteration
commences over the top of it.  How your source sound begins will greatly
affect the results, especially the sharpness of attack and initial
amplitude.  Normally, it should have a high amplitude in order to
maximise signal as the filtering progresses.
</p>

<p>
A soundfile with a strong attack and a short <i>delay</i> (e.g., 0.2 or
0.1 sec) will produce a series of pulsations which gradually disappear
into resonance, depending on <i>Q</i>.  It takes quite a low <i>Q</i>
(e.g., well under 10) to hold off the resonance effect for a bit.  The
timing of the transition from the source sound to a resonant effect is
handled by balancing <i>dur</i>, <i>delay</i> and <i>Q</i>.
</p>

<p>
FILTER ITERATED is processor intensive.  Very short values for <i>delay</i>
will increase the processing time, though this does not appear to affect
the demands on available RAM.
</p>
</blockquote>

<h3>
Musical Applications
</h3>

<blockquote>
<p>
The results achieved with FILTER ITERATED can vary widely.  Here is a
listing of some of the main effects:

	<ul>
	<li>long <i>dur</i> &#150; many iterations and plenty of time for
	the repeated filtering to alter the sound</li>
	
	<li>very short <i>delay</i> (&lt; 0.05) &#150; a granular sound which
	gradually becomes a rapidly pulsating resonance; add some
	<i>pshift</i> and it may become a soft, modulating wash</li>

	<li>short <i>delay</i> (e.g., ca 0.1 or 0.2) &#150; rapidfire
	pulsations</li>

	<li>the use of exponential decay (<b>-e</b>) will increase the
	sense of pulsation by dipping the amplitude between iterations</li>

	<li>long <i>delay</i> &#150; gross iterations of the beginning of
	the sound, becoming a bit softer as the filtering takes effect</li>

	<li><i>delay</i> longer than <i>infile</i> &#150; <i>delay</i>
	amounts of <i>infile</i> with gaps between each iteration;  add
	some <i>rand</i> factor and there will be some random overlapping
	of segments</li>

	<li>high <i>Q</i> &#150; the tendency to dissolve into resonance
	will be considerably greater</li>

	<li>high <i>Q</i> with <i>pshift</i> &#150; the resonance 	produced
	as the sound progresses will tend to warble and weave tuned strands</li>

	</ul>

</p>
</blockquote>

<p>
End of FILTER ITERATED<br>
<a href="#FILTLIST"><b>Return</b></a> to list of FILTER functions at top
of this file<br>
<a href="ccdpndex.htm" Target="_top"><b>Return</b></a>
to Main Index for the CDP System.<br>
<a href="cgroundx.htm#startpos" Target="_top"><b>Return</b></a>
to 'Groucho' Time-Domain Index
</p>

<hr><!-- ****************************************************** -->

<h2 id="LOHI">FILTER LOHI &#150; Fixed low pass or high pass filter
</h2>

<h3>
Usage
</h3>
<b>filter lohi mode</b> <i>infile outfile attenuation pass-band
stop-band</i> [<b>-s</b><i>prescale</i>]<br>

<h3>
Modes
</h3>

<blockquote>
<b>1</b>&nbsp; <i>Pass-band</i> and <i>stop-band</i> are given as
frequency in Hz<br>
<b>2</b>&nbsp; <i>Pass-band</i> and <i>stop-band</i> are given as
(possibly fractional) MIDI note values<br>
</blockquote>

<h3>
Parameters
</h3>

<blockquote>
<i>infile</i> &#150; input soundfile to filter<br>
<i>outfile</i> &#150; output (filtered) soundfile<br>
<i>attenuation</i> &#150; gain reduction of the filter, in dB (Range:
0 to -96)
	<blockquote>
	The greater the attenuation, the sharper the filter &#150; but
	it takes longer to calculate.
	</blockquote>
<i>pass-band</i> &#150; last pitch to be passed by the filter<br>
<i>stop-band</i> &#150; first pitch to be stopped by the filter
	<ul>
	<li>If <i>stop-band</i> is above <i>pass-band</i>, this is a
	low pass filter.</li>
	<li>If <i>stop-band</i> is below <i>pass-band</i>, this is a
	high pass filter.</li>
	</blockquote>
<b>-s</b><i>prescale</i> &#150; apply gain on the input to the filtering
process &#150; avoid overflows (Range: 0.005 to 200.0)<br>
</blockquote>

<h3>
Understanding the FILTER LOHI Process
</h3>

<blockquote>
<p>
The lo-pass filter 'lets through' all of the sound below <i>pass-band</i>
and attenuates (makes gradually softer) the frequencies higher than
<i>pass-band</i>, ending at <i>stop-band</i>.
</p>

<p>
The high-pass filter 'lets through' all of the sound above <i>pass-band</i>
and attenuates (makes gradually softer) the frequencies lower than
<i>pass-band</i>, ending at <i>stop-band</i>.
</p>

<p>
The key is how the <i>pass-band</i> and <i>stop-band</i> are placed
against the significant frequencies of the source sound.  As mentioned
elsewhere, it may be useful to perform a spectral analysis on <i>infile</i>
and make a report with <a href="cspecinf.htm#PEAK"><b>SPECINFO PEAK</b></a>.
</p>

<p>
An interesting fact about the operation of the filters has recently 
been observed.  With the hipass-lopass filter (FILTER LOHI &#150; and 
possibly with other filters?), if your source file has LOTS of silence 
at the end, the filter suddenly slows down by a factor of 20 (or more!!) 
in the silent buffers.  At the moment, we don't know why this happens 
&#150; there's no known bug in the code.  So you are recommended to 
'topntail' (ENVEL DOVETAIL) any long sounds that fade away to nothing 
before running them through filters.
</p>
</blockquote>

<h3>
Musical Applications
</h3>

<blockquote>
<p>
These basic filter operations can be used to clean up a sound by
removing excessive bass with a high-pass filter, or some hiss (if it
is above significant frequencies in the source) with a low-pass filter.
</p>

<p>
Musically, a high-pass filter makes the sound 'thin' by removing the
bottom, and a low-pass filter makes the sound deep and rumbling by
removing the top.
</p>
</blockquote>

<p>
End of FILTER LOHI<br>
<a href="#FILTLIST"><b>Return</b></a> to list of FILTER functions at top
of this file<br>
<a href="ccdpndex.htm" Target="_top"><b>Return</b></a>
to Main Index for the CDP System.<br>
<a href="cgroundx.htm#startpos" Target="_top"><b>Return</b></a>
to 'Groucho' Time-Domain Index
</p>

<hr><!-- ****************************************************** -->

<h2 id="PHASING">FILTER PHASING &#150; Phase shift sound, or produce
phasing effect
</h2>

<h3>
Usage
</h3>
<b>filter phasing mode</b> <i>infile outfile gain delay</i>
[<b>-s</b><i>prescale</i>] [<b>-l</b>]<br>

<h3>
Modes
</h3>

<blockquote>
<b>1</b>&nbsp; Allpass filter (phase-shifted)<br>
<b>2</b>&nbsp; Phasing effect
</blockquote>

<h3>
Parameters
</h3>

<blockquote>
<i>infile</i> &#150; input soundfile to phase shift<br>
<i>outfile</i> &#150; output (phase-shifted) soundfile<br>
<i>gain</i> &#150; amplitude adjustment (Range: -1.0 to 1.0)
	<blockquote>
	In Mode <b>2</b> the phasing effect increases as <i>gain</i>
	increases from -1.0, but a <i>gain</i> of 1.0 will produce
	complete phase cancellation and the output signal will be 0.
	</blockquote>
<i>delay</i> &#150; time in milliseconds between return of delayed
material (Range: 0.045 to 1644.35 ms)
	<blockquote>
	<i>Delay</i> may vary over time.
	</blockquote>
<b>-s</b><i>prescale</i> &#150; scale gain on the <b>input</b> to the
filtering process (Range: 0.0 to 1.0; the Default is 1.0)<br>
<b>-l</b> &#150; linear interpolation of changing delay values (Default:
logarithmic)<br>
</blockquote>

<h3>
Understanding the FILTER PHASING Process
</h3>

<blockquote>
<p>
The 'phasing effect' is a kind of sweeping band passing through the
sound, such as is sometimes heard when aeroplanes fly overhead, and
is much used in popular music.
</p>

<p>
Increasing the <i>gain</i> factor has some effect on the reverberant
quality of the sound.  So does increasing the <i>delay</i> time.  The
sound will still sound quite dry with <i>delay</i> &lt; 20 (ms).
Between about 20 and 45 ms there is a touch of resonance in the
sound.  Around 50 ms there is significant echoey reverberation (though
somewhat granulated), and after 100 ms we start to hear larger portions
of the sound repeating.
</p>

<p>
Overall, the degree of reverberant effect is controlled by increasing
both the <i>gain</i> and <i>delay</i> parameters in tandem.
</p>
</blockquote>

<h3>
Musical Applications
</h3>

<blockquote>
<p>
Used with care, this function can be used to produce a variety of
reverberant effects.  The mid-range results are similar to the sound
of a loud clap in a stairwell or under the overhang of a cement building.
</p>

<p>
Longer <i>delay</i> times will produce echo effects, but also see
<a href="cgromody.htm#REVECHO"><b>MODIFY REVECHO</b></a> for echoes proper,
as well as the other <a href="cxreverb.htm"><b>REVERB</b></a> options.
</p>
</blockquote>

<p>
End of FILTER PHASING<br>
<a href="#FILTLIST"><b>Return</b></a> to list of FILTER functions at top
of this file<br>
<a href="ccdpndex.htm" Target="_top"><b>Return</b></a>
to Main Index for the CDP System.<br>
<a href="cgroundx.htm#startpos" Target="_top"><b>Return</b></a>
to 'Groucho' Time-Domain Index
</p>

<hr><!-- ========================================================================= -->
<h2 id="PHASOR">PHASOR &#150; introduce phasing into (mono) signal</h2>

<h3>
Usage
</h3>
<b>phasor phasor</b> <i>infile outfile streams phasfrq shift ochans</i> [<b>-o</b><i>offset</i>] [<b>-s</b>] [<b>-e</b>]

<h3>
Parameters
</h3>
<blockquote>
<i>infile</i> &#150; input soundfile (MONO).<br>
<i>outfile</i> &#150; output soundfile (MONO, STEREO or MULTI-CHANNEL).<br>
<i>streams</i> &#150; number of output streams that phase-interact. (Range 2 to 8; &gt;= <i>ochans</i>)<br>  
<i>phasfrq</i> &#150; frequency of packets (phase shifts forward then back in a single packet). (Hz)<br> 
<i>shift</i> &#150; maximum phaseshift with packet. (Range 0 - 12 semitones) <br>
<i>ochans</i> &#150; number of output channels (not greater than the number of streams). (Range: 1 to 8)<br>
<b>-o</b><i>offset</i> &#150; streams may be time-offset from one another:  <i>offset</i> is the time-offset of the most-offset stream. (Range 0 - 500 mS)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
The other streams are offset by intermediate amounts.<br>
<b>-s</b> &#150; output channels (loudspeakers) encircle the audience; use only with more than two output channels<br>
<b>-e</b> &#150; prints warnings about rounding-errors in calculating time-shifted streams.
<br><br>
<b><i>shift</i> and <i>phasfrq</i> can vary through time, but extreme <i>phasfrq</i> changes or reversals will produce anomalous output.</b>

</blockquote>

<h3>
Understanding the PHASOR Process
</h3>

<blockquote>
<p>
PHASOR produces a phasing effect, with mono, stereo or multi-channel output. The signal is divided into a number of output <i>streams</i> that phase-interact. The key paramaters are phase frequency (<i>phasfrq</i>) and pitch shift <i>shift</i>, which actually drives the phasing process (value 0 has no phasing effect). There is also an optional <i>offset</i> parameter which time-offsets the streams: even without pitch shifting, this is an effective way of creating a pseudo-stereo effect out of a mono signal, since it is phase and timing differences that create the stereo illusion.
</p><p>
The program can produce a chorus effect, too, by setting <i>phasfrq</i> fairly low (e.g. 0.5), plus some pitch shift (e.g. 2) and <i>offset</i> (&gt;40mS). As a phasing effect, PHASOR surpasses the earlier FILTER PHASING 2, although the latter has some value for chorusing. 
</blockquote>

<h3>
Musical Applications
</h3>

<blockquote>
<p>
...
</p>
</blockquote>

<p>
End of PHASOR<br>
<a href="#FILTLIST"><b>Return</b></a> to list of FILTER functions at top
of this file<br>
<a href="ccdpndex.htm" Target="_top"><b>Return</b></a>
to Main Index for the CDP System.<br>
<a href="cgroundx.htm#startpos" Target="_top"><b>Return</b></a>
to 'Groucho' Time-Domain Index
</p>


<hr><!-- ****************************************************** -->

<h2 id="SWEEPING">FILTER SWEEPING &#150; Filter whose focus-frequency
sweeps over a range of frequencies
</h2>

<h3>
Usage
</h3>
<b>filter sweeping mode</b> <i>infile outfile acuity gain lofrq hifrq
sweepfrq</i> [<b>-p</b><i>phase</i>]<br>

<h3>
Modes
</h3>

<blockquote>
<b>1</b>&nbsp; High-pass<br>
<b>2</b>&nbsp; Low-pass<br>
<b>3</b>&nbsp; Band-pass<br>
<b>4</b>&nbsp; Notch (band-reject)
</blockquote>

<h3>
Parameters
</h3>

<blockquote>
<i>infile</i> &#150; input soundfile<br>
<i>outfile</i> &#150; output soundfile<br>
<i>acuity</i> &#150; tightness of the filter (Range: 0.000100 to 1.0)
	<blockquote>
	Smaller values give a tighter filter.
	</blockquote>
<i>gain</i> &#150; overall gain on output (Range: 0.001000 to 10000.0)
	<blockquote>
	<b>Rule of thumb:</b> If <i>acuity</i> = (1&#47;3)-to-power-n,
	<i>gain</i> = (2&#47;3)-to-power-n.
	</blockquote>
<i>lofrq</i> &#150; lowest frequency to sweep to (Range: 10.0 to
sample_rate&#47;2)<br>
<i>hifrq</i> &#150; highest frequency to sweep to (Range: 10.0 to
sample_rate&#47;2)<br>
<i>sweepfrq</i> &#150; frequency of the sweep itself (Range: 0.0 to 200;
the Default is <i>infile</i>_duration&#47;2)
	<blockquote>
	For example, to sweep once over the time of the soundfile, set
	<i>sweepfrq</i> to <i>infile</i>_duration&#47;2 and set
	<i>phase</i> to 0 (upsweep) or 0.5 (downsweep)
	</blockquote>
<b>-p</b><i>phase</i> &#150; start position of the sweep (Range: 0 to 1;
the Default is 0.25 &#150; midway along the rising curve)
	<blockquote>
	Imagine a series of points along a rising and falling curve.  The
	curve begins at 0 (= <i>lofrq</i>) rises to 0.5 (= <i>hifrq</i>),
	and moves on to 1, falling back to <i>lofrq</i>.  The <i>phase</i>
	value identifies where along this curve the sweep shape begins.
	</blockquote>

	<blockquote>
	<i>Acuity</i>, <i>lofrq</i>, <i>hifrq</i> and <i>sweepfrq</i> may
	all vary over time.
	</blockquote>
</blockquote>

<h3>
Understanding the FILTER SWEEPING Process
</h3>

<blockquote>
<p>
This filter is most effective in Band-pass or Low-pass mode, with low
<i>acuity</i>.  It is difficult to get a result in High-pass mode.
A tight filter makes the sweep more audible, but too tight and it may
appear as a thin sine wave (resonance) which doesn't really connect
with the sound.
</p>

<p>
A fairly long soundfile and a fairly broad range of frequencies gives
this function something to work with.
</p>

<p>
Watch for overflows and reduce the <i>gain</i> as necessary.
</p>
</blockquote>

<h3>
Musical Applications
</h3>

<blockquote>
<p>
With <i>acuity</i> less than 0.1 (tight) and a <i>sweepfrq</i> less than
0.5 (slow), one can produce wah-wah effects.  Sometimes it may be useful
to cut only a segment of these timbrally modulating glissandi for use
as a separate soundfile.
</p>

<p>
With sweep frequencies of, for example, 20 or 100, and perhaps a wider
<i>acuity</i>, one can produce fluttering effects, the wider the
<i>acuity</i>, the 'looser' the flutter&#47;flapping effect.
</p>

<p>
Sometimes, with tighter <i>acuity</i> settings, one can hear movement
through the harmonic overtone series.
</p>
</blockquote>

<p>
End of FILTER SWEEPING<br>
<a href="#FILTLIST"><b>Return</b></a> to list of FILTER functions at top
of this file<br>
<a href="ccdpndex.htm" Target="_top"><b>Return</b></a>
to Main Index for the CDP System.<br>
<a href="cgroundx.htm#startpos" Target="_top"><b>Return</b></a>
to 'Groucho' Time-Domain Index
</p>

<hr><!-- ****************************************************** -->

<h2 id="USERBANK">FILTER USERBANK &#150; User-defined filterbank, with
time-varying <i>Q</i>
</h2>

<h3>
Usage
</h3>
<b>filter userbank mode</b> <i>infile outfile datafile Q gain</i>
[<b>-d</b>]<br>

<h3>
Modes
</h3>

<blockquote>
<b>1</b>&nbsp; The pitches to filter are entered as frequency in Hz<br>
<b>2</b>&nbsp; The pitches to filter are entered as MIDI note values<br>
</blockquote>

<h3>
Parameters
</h3>

<blockquote>
<i>infile</i> &#150; input soundfile to filter<br>
<i>outfile</i> &#150; output (filtered) soundfile<br>
<i>datafile</i> &#150; contains the pitch and amplitude of the filters
(paired, one pair on each line)
	<ul>
	<li>Pitch: as Hz or MIDI note values (Range: 10Hz to
	    sample_rate&#47;3)</li>
	<li>Amplitude: amplitude level (Range: 0.00100 to 10000.0 or 	entered as dB values)</li>
	<li>Comment lines (starting with ';') may be used.</li>
	</ul>

<i>Q</i> &#150; tightness of filter (Range: 0.001000 to 10000.0) &#150;
the higher the value the more tightly the filter is focused on the centre
frequency of that filter.
	<blockquote>
	<i>Q</i> may vary over time.
	</blockquote>
<i>gain</i> &#150; overall gain (Range: 0.001000 to 10000.0)<br>
<b>-d</b> &#150; double filtering<br>
</blockquote>

<h3>
Understanding the FILTER USERBANK Process
</h3>

<blockquote>
<p>
Here <i>Q</i> may vary over time, but the frequency settings are fixed
for the duration of the sound.  The tightness of the <i>Q</i> determines
how much of the original sound 'comes through', or, to put it another
way, the degree to which the sound is tuned to the frequencies defined
in the filter bank.
</p>

<p>
Much of the effectiveness of the function therefore depends on the
design of the <i>datafile</i>.  Normally, dB amplitude settings will
fall within a 0dB to -96dB range, but the function does allow dB
greater than 0 (i.e., applying gain to the sound).  If you have
existing filter bank files with dB greater than 0 and they overload,
you can use <i>gain</i> with values below zero to scale the amplitudes
back within range &#150; i.e., without having to edit your file.
</p>
</blockquote>

<h3>
Musical Applications
</h3>

<blockquote>
<p>
As with any graphic equaliser, this function can be used to emphasize
or de-emphasize different frequency regions of the source sound.
</p>

<p>
It can also be used to impart a harmonic sonority to a sound.  The
higher the <i>Q</i>, the clearer the pitched effect (e.g., values
between 300 and 1000).  Given a source with a rapidly changing amplitude
envelope, this may come across as a series of harmonic scintillations,
whereas a sound with a steadier amplitude envelope will become a chord.
</p>
</blockquote>

<p>
End of FILTER USERBANK<br>
<a href="#FILTLIST"><b>Return</b></a> to list of FILTER functions at top
of this file<br>
<a href="ccdpndex.htm" Target="_top"><b>Return</b></a>
to Main Index for the CDP System.<br>
<a href="cgroundx.htm#startpos" Target="_top"><b>Return</b></a>
to 'Groucho' Time-Domain Index
</p>

<hr><!-- ****************************************************** -->

<h2 id="VARIABLE">FILTER VARIABLE &#150; Lo-pass, High-pass, Band-pass
or Notch filter with time-varying frequency
</h2>

<h3>
Usage
</h3>
<b>filter variable mode</b> <i>infile outfile acuity gain frq</i><br>

<h3>
Modes
</h3>

<blockquote>
<b>1</b>&nbsp; High-pass<br>
<b>2</b>&nbsp; Low-pass<br>
<b>3</b>&nbsp; Band-pass<br>
<b>4</b>&nbsp; Notch (Band reject)
</blockquote>

<h3>
Parameters
</h3>

<blockquote>
<i>infile</i> &#150; input soundfile to filter<br>
<i>outfile</i> &#150; output (filtered) soundfile<br>
<i>acuity</i> &#150; tightness of the filter (Range: 0.000100 to 1.0)
	<blockquote>
	Smaller values give a tighter filter.
	</blockquote>
<i>gain</i> &#150; overall gain on output (Range: 0.001000 to 10000.0)
	<blockquote>
	<b>Rule of thumb:</b> If <i>acuity</i> = (1&#47;3)
	<sup>-to-power-n</sup>,
	<i>gain</i> = (2&#47;3)<sup>-to-power-n</sup>.
	</blockquote>
<i>frq</i> &#150; frequency of the filter (Range: 10.0 to
sample_rate&#47;2)
	<blockquote>
	<i>Acuity</i> and <i>frq</i> may vary over time.
	</blockquote>
</blockquote>

<h3>
Understanding the FILTER VARIABLE Process
</h3>

<blockquote>
<p>
The <i>acuity</i> parameter controls the rate at which the amplitude
decreases as one moves away from <i>frq</i>.  The faster the rate,
or, to put it more technically, the steeper the slope of the roll-off,
the more the resulting sound is focused on <i>frq</i> (Band-pass),
or the area above (Hi-pass) or below (Lo-pass) <i>frq</i>, or
omits the area around <i>frq</i> (Notch).  It is best not to make
the <i>acuity</i> too tight with this filter, as the resonance
produced may become unpredictable.
</p>

<p>
Hi-pass and Lo-pass are not very effective in FILTER VARIABLE, which
has been designed as a 'lightweight', fast filter.  For more powerful
Hi-pass and Lo-pass filtering, it is recommended that you use
<a href="#LOHI"><b>FILTER LOHI</b></a>.
</p>

<p>
Because a filter often creates resonance (boosts the amplitude
of frequencies in a certain frequency area), especially with a broader
roll-off region, overload can easily occur.  FILTER VARIABLE reports any
overflows, in which case the <i>outfile</i> should be deleted <i>without
being played</i> and the function run again with a reduction in the
<i>gain</i>.
</p>
</blockquote>

<h3>
Musical Applications
</h3>

<blockquote>
<p>
FILTER VARIABLE provides a convenient environment for exploring the
effect of a variety of filter types on a given sound.
</p>
</blockquote>

<p>
End of FILTER VARIABLE<br>
<a href="#FILTLIST"><b>Return</b></a> to list of FILTER functions at top
of this file<br>
<a href="ccdpndex.htm" Target="_top"><b>Return</b></a>
to Main Index for the CDP System.<br>
<a href="cgroundx.htm#startpos" Target="_top"><b>Return</b></a>
to 'Groucho' Time-Domain Index
</p>

<hr><!-- ****************************************************** -->

<h2 id="VARIBANK">FILTER VARIBANK and VARIBANK2 &#150; User-defined time-varying
filterbank, with time-varying <i>Q</i>
</h2>

<!-- 
TW: YOu could list VARIBANK2 with this.
TW: THis new program is exactly like VARIBANK, except that, at the foot
TW: of the filter data file,
TW: you add a line with a '#' sign
TW: Followed by lines which specify the way the partials vary over time.
TW: The default (in VFILTERS) is harmonics at 2,3,4,5,etc. times the given freq.
TW: in VARIBANK2 you can specify the partials thus...e.g.....
TW: 0  1 .5  2.2  .7   4.6532   .5
TW: 10 1 .25 2.4  .2   3   	  .14
TW: The first value in each line is a time.
TW: THe following values are in pairs representing
TW: partial numbers (which can now be fractional)
TW: and their relative amplitude.
TW: As with the freqency (or MIDI) data already given,
TW: there must be the same number of values in each line.
TW: Where a partial is absent, give it a value of zero.
 -->

<h3>
Usage
</h3>
<b>filter varibank mode</b> <i>infile outfile datafile Q gain</i>
[<b>-h</b><i>hcount</i>] [<b>-r</b><i>rolloff</i>] [<b>-d</b>]<br>
<br />
<b>filter varibank2 mode</b> <i>infile outfile datafile Q gain</i>
[<b>-t</b><i>tail</i>] [<b>-d</b>]<br>

<h3>
Modes
</h3>

<blockquote>
<b>1</b>&nbsp; The pitches to filter are entered as frequency in Hz<br>
<b>2</b>&nbsp; The pitches to filter are entered as MIDI note values<br>
</blockquote>

<h3>
Parameters
</h3>

<blockquote>
<i>infile</i> &#150; input soundfile to filter<br>
<i>outfile</i> &#150; output (filtered) soundfile<br>
<i>datafile</i> &#150; contains lines of data for filter bands at successive
times
	<ul>
	<li>Each line contains data in a certain format.</li>
	<li>This format is: <i>Time: Pitch1 Amp1</i> [<i>Pitch2 Amp2</i>
	    etc...]</li>
	<li>The Pitch and Amplitude values must be paired, but any number of
	    pairs can be used on one line.</li>
	<li>All the lines in <i>datafile</i> must have the <b>same number
	    of pairs</b>.</li>
	<li>To eliminate a band in any line(s), set its amplitude to 0.0)</li>
	<li>Time values are in seconds and must be in ascending order
	    and &gt;= 0.0</li>
	<li>Pitch values may be entered as frequency in Hz (Mode <b>1</b>)
	    or as MIDI note values (Mode <b>2</b>)</li>
	<li>Amplitude values may be numeric or expressed as dB values
	    (e.g., -4.1dB)</li>
	<li>Comment lines may be used &#150; they must begin with ';'</li>
	<li>In FILTER VARIBANK2, you can also specify partials and their 
	relative weighting.  To do this you add a '#' sign on the next line 
	at the bottom of the <i>datafile</i>, followed by lines which specify 
	the way the partials vary over time.  The default (in 
	<a href="#VFILTERS"><b>VFILTERS</b></a>) is <i>harmonics</i> at 2,3,4,5,etc. 
	times the given frequency (as MIDI pitch or frequency).  In FILTER 
	VARIBANK2 you can specify the partials in this format to add changing 
	timbral colouring (also see below):
	<pre>
	#
	<font color="#FF0000">Time Partials with Amplitude weighting (pairs)]</font>
	0    1 .5  2.2  .7   4.6532   .5
	4.5  1 .25 2.4  .2   3        .14
	</pre>
	</li>

	<li>See a synopsis of the file format in <a href="filestxt.htm#FILTERVFILES">
	<b>CDP Files &amp; Codes</b></a>.</li>
	</ul>
<i>Q</i> &#150;  tightness of filter (Range: 0.001000 to 10000.0) &#150;
the higher the value the more tightly the filter is focused on the centre
frequency of that filter.
	<blockquote>
	<i>Q</i> may vary over time.
	</blockquote>
<i>gain</i> &#150; overall gain on output (Range: 0.001000 to 10000.0)<br>
<b>-h</b><i>hcount</i> &#150; number of harmonics of each pitch to use
(Default: 1)
	<blockquote>
	The high harmonics of high pitches may go beyond the Nyquist
	frequency (sample_rate&#47;2)
	</blockquote>
<b>-r</b><i>rolloff</i> &#150; decrease in amplitude level in dB from
one harmonic to the next (Range: 0 to -96)<br>
<b>-t</b><i>tail</i> &#150; duration of decay tail (Range: 0 to 20 secs)<br>
<b>-d</b> &#150; double filtering
</blockquote>

<h3>
Understanding the FILTER VARIBANK Process
</h3>

<blockquote>
<p>
The frequencies specified in the <i>datafile</i> are in fact the
centre-frequencies of a filter band.  With a tight <i>Q</i>,
these specific frequencies will be heard as pitches;  with a relaxed
<i>Q</i>, these specific frequencies will locate a relatively fuzzy
pitch region.  The pitch will glissando between different pitch levels
when these differ between time points.
</p>

<p>
Note that if the <i>datafile</i> has, for example, 10 Pitch&#47;Amplitude
pairs on a line, each column of paired values relates to a given 'band'.
Thus the change over time for each band will be specified by the
sequence of paired values in a given column.  The value for <i>Q</i> is
not contained in the <i>datafile</i>, but the time points for changes
in <i>Q</i> can be made to match or vary from those in the <i>datafile</i>.
</p>

<p>
In the additional lines supplied for the FILTER VARIBANK2 option, the 
<b>first value</b> in each line is a <b>time</b>.  The <b>following 
values</b> are in pairs representing the <b>partials</b> (they can 
in fact be ANY number) and their <b>relative amplitude</b>.  Note 
that as with the frequency (or MIDI) data already given, there must be 
the same number of entries in each line.  If you want to omit a partial 
at given times, give it an amplitude of 0.
<p>

<p>
Thus you might omit the second partial during specified times:
<pre>
<font color="#FF0000">Time Partials with Amplitude weighting (pairs)]</font>
0    1 0.3  2.237 0.4  7.615 0.8
1    1 0.3  2.37  0    7.615 0.8  <font color="#FF0000">[partial 2.37 disappears</font>
2    1 0.3  2.37  0    7.615 0.8  <font color="#FF0000">during these times]</font>
3    1 0.3  2.37  0.4  7.615 0.8
</pre>
The partials could also be changing:
<pre>
0    1 0.3  2.237 0.4  7.615 0.8 
1    1 0.3  3.34  0   14.22  0.8 
2    1 0.3 16.3   0    8.322 0.8 
3    1 0.3 22.6   0.4  7.615 0.8
</pre>
</p>

<p>
Here's a complete example, with VARIBANK + VARIBANK2 data:<br>
<p>
<div align=left>  <!-- orig center -->
<table border="1" cellpadding="3" bgcolor="#B0E0E6">
<caption><b>Example Data and Q settings for FILTER VARIBANK</b></caption>

<tr>
<th align=center colspan=8><b>Datafile</b></th>
<th><b> | </b></th>
<th align=center colspan=3><b>Q-file</b></th>

</tr>

<tr>
<th align=center><b>Time</b></th>
<th align=center><b>Pitch1</b></th>
<th align=center><b>Amp1</b></th>
<th align=center><b>Pitch2</b></th>
<th align=center><b>Amp2</b></th>
<th align=center><b>Pitch3</b></th>
<th align=center><b>Amp3</b></th>
<th align=center><b>Description</b></th>
<th align=center><b> | </b></th>
<th align=center><b>Time</b></th>
<th align=center><b>Q</b></th>
<th align=center><b>Description</b></th>
</tr>

<tr>
<td>0.0</td>
<td>53</td>
<td>-3dB</td>
<td>53</td>
<td>-3dB</td>
<td>53</td>
<td>-3dB</td>
<td>F below Middle C</td>
<td><b> | </b></td>
<td>0.0</td>
<td>5000</td>
<td>Very tight focus</td>
</tr>

<tr>
<td>2.0</td>
<td>65</td>
<td>0dB</td>
<td>53</td>
<td>0dB</td>
<td>41</td>
<td>0dB</td>
<td>F in 3 octaves</td>
<td><b> | </b></td>
<td>2.0</td>
<td>70</td>
<td>Very fuzzy</td>
</tr>

<tr>
<td>3.0</td>
<td>57</td>
<td>-6dB</td>
<td>54</td>
<td>-6dB</td>
<td>50</td>
<td>-6dB</td>
<td>D-Major chord</td>
<td><b> | </b></td>
<td>3.0</td>
<td>2000</td>
<td>Mid-range pitch focus</td>
</tr>

<tr>
<td>4.5</td>
<td>67</td>
<td>-3dB</td>
<td>62</td>
<td>-3dB</td>
<td>59</td>
<td>-3dB</td>
<td>G-major, 1<sup>st</sup> inversion</td>
<td><b> | </b></td>
<td>4.5</td>
<td>2000</td>
<td>No change</td>
</tr>

<tr>
<td>7.0</td>
<td>64</td>
<td>-3dB</td>
<td>60</td>
<td>0dB</td>
<td>60</td>
<td>-2dB</td>
<td>2 Middle C's &amp; 1 E</td>
<td><b> | </b></td>
<td>7.0</td>
<td>5000</td>
<td>Very tight pitch focus</td>
</tr>

<tr>
<td colspan="7">#</td>
<td colspan="5">'#' sign for VARIBANK2 information to come</td>
</tr>

<tr>
<th>Time</th>
<th>Par1</th>
<th>Amp2</th>
<th>Par2</th>
<th>Amp3</th>
<th>Par3</th>
<th>Amp1</th>
<td colspan="5">NB: Same number of pairs on each line</td>
</tr>

<tr>
<td>0</td>
<td>1</td>
<td>0.5</td> 
<td>2.2</td>
<td>0.7</td>
<td>4.6532</td>
<td>0.5</td>
<td colspan="5">Time + partial - amplitude_weight pairs</td>
</tr>

<tr>
<td>4.5</td>
<td>1</td>
<td>0.25</td>
<td>2.4</td>
<td>0.2</td>
<td>3.0</td>
<td>0.14</td>
<td colspan="5">Put zero amp if you want to omit a given partial</td>
</tr>
</table>
</div>
</p>

<p>
The whole file (version for FILTER VARIBANK2) therefore looks like this:
<pre>
0.0 53 -3dB 53 -3dB 53 -3dB
2.0 65  0dB 53  0dB 41  0dB
3.0 57 -6dB 54 -6dB 50 -6dB
4.5 67 -3dB 62 -3dB 59 -3dB
7.0 64 -3dB 60  0dB 60 -2dB
#
0    1 0.5   2.2 0.7  4.6532 0.5 
4.5  1 0.25  2.4 0.2  3.0    0.14
</pre>
</p>

<p>
Higher values for <i>Q</i> filter the sound more, which reduces overall
amplitude.  Higher <i>Q</i> therefore allows for and sometimes requires
higher <i>gain</i> levels.  Similarly, lower values for <i>Q</i> 'let
through' more of the original sound, so there is less amplitude reduction
through the filtering process, and therefore more likelihood of overflows.
Higher values for <i>hcount</i> also increase the tendency to overflow,
because there are more harmonics in the filter effect.  These harmonics
enrich the sound.
</p>

<p>
The data in the two files used in the above example were used in a
command line with Mode <b>2</b>, a <i>gain</i> of 20 and <i>hcount</i>'s
of 6 and 12.  Also try it without using <i>hcount</i> to hear the
difference.  This was the full command line:
	<blockquote>
	<code>filter varibank2 2 infile outfile datafile.txt qfile.txt
	20 -h12</code>
	</blockquote>
The input was a sustained trombone tone on F below Middle C, which is
why the filter frequency began at MIDI note 53.
</p>

<p>
Mapping out the data with a little diagram may be helpful:
	<ul>
	<li>Vertical lines to mark the time points</li>
	<li>A series of horizontal lines rising and falling towards
	    each time point (or not changing) to indicate pitch levels
	    (use MIDI note values &amp; Mode <b>2</b> unless exact
	    frequencies are crucial);  label the MIDI notes on your diagram.</li>
	<li>Write an amplitude value in dB next to each pitch, possibly
	    in a different colour</li>
	<li>Put 'tight' at the top left of your diagram and 'relaxed'
	    at the bottom left, in a different colour:  this is the
	    <i>Q</i> scale</li>
	<li>Draw a line for changing <i>Q</i> in the <i>Q</i> colour,
	    changing direction &#150; or staying the same &#150; at
	    each time point.</li>
	</ul>
</p>
</blockquote>

<h3>
Musical Applications
</h3>

<blockquote>
<p>
The facilities of FILTER VARIBANK are a composer's dream.  Not only can
the frequencies of the filterbank be specified in precise detail, but
the frequencies may move in time.  Not only can the tightness of the
filters &#150; the degree to which they focus on pitches &#150; be
specified, but this focus can also change over time.  The number of
harmonics and the amplitude 'rolloff' are also under the composer's
control.
</p>

<p>
It is possible, therefore, to play with relationships between pitched
tones and complex sounds with some degree of noise components.  Working
with sounds accepts all kinds of sonic material into the fabric of
musical discourse &#150; but pitch need not be excluded simply because
a broader range of materials is being used.  A tool like FILTER
VARIBANK makes it possible gradually to focus complex sonic material
into specific pitches, thus creating links with other pitched
elements, such as a broader harmonic scheme and the use of acoustic
musical instruments.
</p>
</blockquote>

<p>
End of FILTER VARIBANK<br>
<a href="#FILTLIST"><b>Return</b></a> to list of FILTER functions at top
of this file<br>
<a href="ccdpndex.htm" Target="_top"><b>Return</b></a>
to Main Index for the CDP System.<br>
<a href="cgroundx.htm#startpos" Target="_top"><b>Return</b></a>
to 'Groucho' Time-Domain Index
</p>

<hr><!-- ****************************************************** -->
<h2 id="VFILTERS">FILTER VFILTERS &#150; Make datafiles for fixed-pitch
FILTER VARIBANK filters
</h2>

<h3>
Usage
</h3>
<b>filter vfilters</b> <i>inpitchfile generic_outfilterbankfile</i>
<br>

<h3>
Parameters
</h3>

<blockquote>
<i>inpitchfile</i> &#150; contains a list of MIDI Pitch Values or 
frequency pitch values, with one or more values on each line<br />
<i>generic_outfilterbankfile</i> &#150; each line is converted into 
a data file for a pitched pitch(es) filter for 
<a href="cgrofilt.htm#VARIBANK"><b>FILTER VARIBANK</b></a>.  The 
outfile names are whatever you put for <i>generic_outfilterbankfile</i> 
plus a '0', '1', etc. appended, producing a different file for each line 
in <i>inmidifile</i>.
</blockquote>

<h3>
Understanding the FILTER VFILTERS Function
</h3>

<blockquote>
<p>
FILTER VFILTERS creates one or more data file(s) for the 
FILTER VARIBANK process from a list of MIDI Pitch Values 
(MPV's), one file for each line of input.  The output basic 
filterbank file is a fixed (not time-varying) pitches filter. 
If the <i>inmidifile</i> is:
<pre>
48 63.5 70 74 81
</pre>
the <i>generic_outfilterbankfile</i> will be (edited here for 
conciseness):
<pre>
<font color="#FF0000">
[Time MPV Amp  MPV  Amp  MPV Amp  MPV Amp  MPV  Amp]</font>
0     48  1    63.5 1    70  1    74  1    81	 1
10000 48  1    63.5 1    70  1    74  1    81	 1
</pre>
The second line with <i>time</i> = 10000 means that the filter 
values given extend (without changing) from 0 seconds to 
10000 seconds (i.e., the end of the file).  The program 
adds it because it needs to have two time values in a 
varibank data file.
</p>

<p>
It actually doesn't matter whether the values in <i>inmidifile</i> 
are MIDI or frequency values.  The input is just treated as numbers 
which go into the output.  If you put in what you think is MIDI, 
the output will be in MIDI.  If you put in what you think is 
frequency, the output will be frequency.  Many musicians find it 
easier to think of harmonies in the MIDI Pitch Value system, 
so this is illustrated here.  These MIDI Pitch Values, please note, 
may be fractional (microtonal).
</p>

<p>
Note that the data in VARIBANK filters can also be generated,
and transposed from the <i>Sound Loom</i> Table Editor.
</p>

<p>
BATCHFILES can be expanded to use a sequence of different
values on the same, or a series of different sources, using
the facilities in the <i>Sound Loom</i> Table Editor.
</p>
</blockquote>

<h3>
Musical Applications
</h3>

<blockquote>
<p>
FILTER VFILTERS will help you to generate data files for 
the <a href="#VARIBANK"><b>FILTER VARIBANK</b></a> process more quickly. 
</p>
</blockquote>

<p>
End of FILTER VFILTERS<br>
<a href="#FILTERLIST">Return</a> to List of functions for interacting
spectra at top of this file<br>
<a href="ccdpndex.htm" Target="_top"><b>Return</b></a>
to Main Index for the CDP System.<br>
<a href="cgroundx.htm#startpos" Target="_top"><b>Return</b></a>
to 'Groucho' Time-Domain Index
</p>


<!-- ========================================================================= -->



<!-- ********************************************************** -->
  <div id = "footer">
   <p>
    <address>
    Last Updated 11 Apr 2023 for CDP8<br />
    Documentation: Archer Endrich<br />
    Revisions: Robert Fraser<br>
    All observations &amp; ideas for improvement appreciated<br />
    Composers Desktop Project Ltd<br />
    Email: cdpse9@gmail.com<br />
    &#169; Copyright 1998-2023 Archer Endrich &amp; CDP<br>
    </address>
   </p>
  </div>

</div> <!-- End of 'right' (contents) indentation -->

</body>

</html>